<% form_object = TaskForm.new if false %>
<%= form_with model: form_object,
              url: form_object.form_path,
              method: form_object.form_method,
              class: "mx-auto space-y-4" do |f| %>
  <%= render Form::SelectComponent.new(
      f,
      :project_id,
      "Projekt",
      form_object.project_options, :id, :title,
      error_field_attribute: :project,
      prompt: "Projekt auswählen",
      selected: form_object.project&.id)
  %>
  <%= render Form::TextFieldComponent.new(f, :title, "Titel") %>
  <%= render Form::TextAreaComponent.new(f, :description, "Beschreibung", rows: 10) %>
  <%= render Form::CoordinatorPickerComponent.new(f, :coordinators, "Ansprechpersonen und Bearbeitende") %>
  <%= render Form::ToggleComponent.new(f, :publish, "Sichtbarkeit") do |toggle| %>
    <% toggle.checked_state_text("Entwurf") %>
    <% toggle.unchecked_state_text("Öffentlich") %>
  <% end %>

  <%= render Form::SubmitButtonGroupComponent.new(f, render_if: !form_object.persisted?) do |save_buttons| %>
    <% save_buttons.button("Speichern", value: "save") %>
    <% save_buttons.button("Speichern & Neu", value: "save_and_new") %>
  <% end %>

  <%= render Form::SubmitButtonGroupComponent.new(f, render_if: form_object.persisted?) do |edit_buttons| %>
    <% edit_buttons.delete_button("Löschen", target_modal_id: "confirm-task-delete") %>
    <% edit_buttons.button("Speichern") %>
  <% end %>
<% end %>

<%= content_for :modal do %>
  <%= render DeleteConfirm::ModalComponent.new(
      id: "confirm-task-delete",
      delete_path: form_object.form_path) do |modal| %>
    <% modal.heading("Aufgabe löschen?") %>
    <% modal.paragraph("Bist du sicher, dass du diese Aufgabe löschen möchtest? Diese Aktion kann nicht rückgängig gemacht werden.") %>
    <% modal.paragraph("Auch alle Meldungen von Mitgliedern, die auf diese Aufgabe eingegangen sind, werden unwiderruflich gelöscht.") %>
  <% end %>
<% end %>
